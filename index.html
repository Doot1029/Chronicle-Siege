<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Chronicle Siege</title>
    <style>
      .theme-midnight {
        --color-primary: #8B5CF6;
        --color-secondary: #EC4899;
        --color-background: #111827;
        --color-surface: #1F2937;
        --color-text-main: #F9FAFB;
        --color-text-secondary: #9CA3AF;
        --color-border: rgba(128, 128, 128, 0.2);
        --color-background-light: #374151;
        --color-disabled: #4B5563;
      }
      .theme-arcade {
        --color-primary: #10B981;
        --color-secondary: #F59E0B;
        --color-background: #0D0C1D;
        --color-surface: #1C1B2E;
        --color-text-main: #FFFFFF;
        --color-text-secondary: #A09FAD;
        --color-border: rgba(160, 159, 173, 0.2);
        --color-background-light: #2E2D40;
        --color-disabled: #4E4D61;
      }
      .theme-scroll {
        --color-primary: #854D0E;
        --color-secondary: #B91C1C;
        --color-background: #FDF6E3;
        --color-surface: #FBF1D5;
        --color-text-main: #654F2D;
        --color-text-secondary: #906C42;
        --color-border: rgba(144, 108, 66, 0.2);
        --color-background-light: #F5E9C9;
        --color-disabled: #D6C6A3;
      }
      .theme-solaris {
        --color-primary: #3B82F6;
        --color-secondary: #F97316;
        --color-background: #F0F9FF;
        --color-surface: #FFFFFF;
        --color-text-main: #075985;
        --color-text-secondary: #334155;
        --color-border: rgba(51, 65, 85, 0.2);
        --color-background-light: #E0F2FE;
        --color-disabled: #94A3B8;
      }

      /* Base Styles */
      *, *::before, *::after { box-sizing: border-box; }

      body {
        background-color: var(--color-background);
        color: var(--color-text-main);
        font-family: 'Inter', sans-serif;
        margin: 0;
        min-height: 100vh;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      h1, h2, h3, h4, h5, h6, .font-serif { font-family: 'Lora', serif; }
      .font-mono { font-family: 'Fira Code', monospace; }
      .font-sans { font-family: 'Inter', sans-serif; }

      /* Animations */
      @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
      @keyframes slideIn { from { transform: translateY(15px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
      @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

      .animate-fade-in { animation: fadeIn 0.5s ease-out; }
      .animate-slide-in { animation: slideIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
      .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
      .animate-pulse-fast { animation: pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite; }

      /* Utilities */
      .w-3 { width: 0.75rem; }
      .h-3 { height: 0.75rem; }
      .w-4 { width: 1rem; }
      .h-4 { height: 1rem; }
      .w-5 { width: 1.25rem; }
      .h-5 { height: 1.25rem; }
      .w-6 { width: 1.5rem; }
      .h-6 { height: 1.5rem; }
      .w-7 { width: 1.75rem; }
      .h-7 { height: 1.75rem; }
      .w-8 { width: 2rem; }
      .h-8 { height: 2rem; }

      /* Layout */
      .container {
        max-width: 1280px;
        margin-left: auto;
        margin-right: auto;
        padding: 1rem;
      }
      @media (min-width: 640px) { .container { padding: 1.5rem; } }
      @media (min-width: 1024px) { .container { padding: 2rem; } }

      /* General Components */
      .card {
        background-color: var(--color-surface);
        padding: 1.5rem;
        border-radius: 1rem;
        box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
        border: 1px solid var(--color-border);
      }
      
      .prose {
        line-height: 1.75;
        white-space: pre-wrap;
      }
      .prose-invert {
        color: var(--color-text-secondary);
      }

      /* Buttons */
      .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: bold;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease-in-out;
        text-align: center;
        width: 100%;
      }
      .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
      .btn:disabled {
        background-color: var(--color-disabled);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }
      .btn-primary { background-color: var(--color-primary); color: white; }
      .btn-primary:hover:not(:disabled) { filter: brightness(1.1); }
      .btn-secondary { background-color: var(--color-secondary); color: white; }
      .btn-secondary:hover:not(:disabled) { filter: brightness(1.1); }
      .btn-icon {
        background: none;
        border: none;
        cursor: pointer;
        padding: 0.25rem;
        color: var(--color-text-secondary);
        transition: color 0.2s;
      }
      .btn-icon:hover { color: var(--color-primary); }
      .btn-icon:disabled { color: var(--color-disabled); cursor: not-allowed; }

      /* Forms */
      .form-input, .form-textarea, .form-select {
        width: 100%;
        padding: 0.75rem;
        background-color: var(--color-background);
        border: 1px solid var(--color-border);
        border-radius: 0.5rem;
        color: var(--color-text-main);
        transition: border-color 0.2s, box-shadow 0.2s;
      }
      .form-input:focus, .form-textarea:focus, .form-select:focus {
        outline: none;
        border-color: var(--color-primary);
        box-shadow: 0 0 0 2px var(--color-primary_opacity_50, rgba(139, 92, 246, 0.5));
      }
      .form-label {
        display: block;
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
        color: var(--color-text-main);
      }
      
      /* Modals */
      .modal-overlay {
        position: fixed;
        inset: 0;
        background-color: rgba(0,0,0,0.75);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 50;
        animation: fadeIn 0.3s;
      }
      .modal-content {
        background-color: var(--color-surface);
        border-radius: 0.75rem;
        box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
        padding: 1.5rem;
        max-width: 90vw;
        width: 100%;
        border: 2px solid var(--color-primary);
        animation: slideIn 0.3s;
      }
      .modal-content.size-sm { max-width: 24rem; }
      .modal-content.size-md { max-width: 32rem; }
      .modal-content.size-lg { max-width: 48rem; }
      .modal-content.size-xl { max-width: 64rem; }
      .modal-content.tall { height: 80vh; display: flex; flex-direction: column; }

      /* Specific Component Stylesheets */

      /* Game Setup */
      .game-setup-wrapper { max-width: 64rem; margin: auto; }
      .game-setup-header { text-align: center; margin-bottom: 2.5rem; }
      .game-setup-header h1 { font-size: 3.75rem; font-weight: bold; color: var(--color-primary); letter-spacing: 0.05em; }
      .game-setup-header p { color: var(--color-text-secondary); margin-top: 0.75rem; font-size: 1.125rem; }
      .game-setup-form { display: flex; flex-direction: column; gap: 2rem; }
      .game-setup-grid { display: grid; grid-template-columns: 1fr; gap: 2rem; }
      @media (min-width: 1024px) { .game-setup-grid { grid-template-columns: 2fr 1fr; } }
      .game-setup-section-header { font-size: 1.5rem; font-weight: 600; color: var(--color-secondary); display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1rem; }
      .game-setup-grid-2col { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
      @media (min-width: 768px) { .game-setup-grid-2col { grid-template-columns: 1fr 1fr; } }
      .game-setup-player-list { max-height: 15rem; overflow-y: auto; padding-right: 0.5rem; }
      .game-setup-player-card { background: rgba(0,0,0,0.2); padding: 1rem; border-radius: 0.5rem; display: flex; flex-direction: column; gap: 0.5rem; }

      /* Game View */
      .game-view-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
      @media (min-width: 1024px) { 
        .game-view-grid { grid-template-columns: repeat(12, 1fr); }
        .game-view-main { grid-column: span 8; }
        .game-view-sidebar { grid-column: span 4; }
      }
      .game-view-main, .game-view-sidebar { display: flex; flex-direction: column; gap: 1.5rem; }
      .story-display { height: 60vh; overflow-y: auto; }
      .story-display-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--color-primary); padding-bottom: 0.5rem; margin-bottom: 1rem; }
      .story-display-header h2 { font-size: 1.5rem; font-weight: bold; }
      .turn-box { background-color: var(--color-surface); padding: 1rem; border-radius: 0.5rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
      .turn-box-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
      .turn-box-header h3 { font-size: 1.125rem; font-weight: 600; color: var(--color-primary); }
      .turn-textarea { height: 10rem; font-size: 1.125rem; }
      .turn-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem; color: var(--color-text-secondary); }
      .turn-actions, .turn-stats { display: flex; align-items: center; gap: 1rem; }
      .ai-critique-box { margin-top: 0.5rem; padding: 0.75rem; background-color: var(--color-background); border-radius: 0.5rem; border: 1px solid #3b82f6; }
      .sidebar-section-header { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.75rem; color: var(--color-secondary); }

      /* Player HUD */
      .player-hud-list { display: flex; flex-direction: column; gap: 0.75rem; }
      .player-card { padding: 0.75rem; border-radius: 0.5rem; transition: all 0.3s; background-color: var(--color-background-light); }
      .player-card.is-current { background-color: var(--color-primary_opacity_20, rgba(139, 92, 246, 0.2)); border-left: 4px solid var(--color-primary); }
      .player-card-header, .player-card-footer { display: flex; justify-content: space-between; align-items: center; }
      .player-card-name { font-weight: bold; color: var(--color-text-main); display: flex; align-items: center; gap: 0.5rem; }
      .player-card-stats { display: flex; align-items: center; gap: 0.5rem; }
      .player-card-hearts { display: flex; align-items: center; gap: 0.25rem; }
      .heart-icon { width: 1.25rem; height: 1.25rem; transition: color 0.2s; }
      .heart-icon.filled { color: #ef4444; }
      .heart-icon.empty { color: var(--color-disabled); }

      /* Intermission View */
      .intermission-overlay {
        position: fixed; inset: 0; background-color: rgba(0,0,0,0.95);
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        z-index: 50; padding: 1rem; overflow-y: auto;
      }
      .intermission-header { text-align: center; width: 100%; max-width: 56rem; }
      .intermission-header h1 { font-size: 2.25rem; line-height: 2.5rem; font-weight: bold; color: var(--color-primary); }
      @media(min-width: 640px) { .intermission-header h1 { font-size: 3.75rem; line-height: 1; } }
      .intermission-header p { color: var(--color-text-secondary); margin-top: 0.5rem; font-size: 1.125rem; }
      .intermission-content {
        width: 100%; max-width: 64rem; background-color: var(--color-surface);
        border-radius: 0.5rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
        padding: 1.5rem; margin: 2rem 0; border: 1px solid var(--color-border);
        flex-grow: 1; min-height: 0; overflow: hidden; display: flex; flex-direction: column;
      }
      .intermission-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; height: 100%; overflow: hidden; }
      @media(min-width: 768px) { .intermission-grid { grid-template-columns: 2fr 1fr; } }
      .intermission-col { display: flex; flex-direction: column; height: 100%; overflow: hidden; }
      .intermission-scrollable { flex-grow: 1; overflow-y: auto; padding-right: 0.5rem; }
      .intermission-footer { text-align: center; width: 100%; max-width: 56rem; }
      .intermission-footer .btn { max-width: 24rem; margin: auto; }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Inter:wght@400;600;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
  <script type="importmap">
{
  "imports": {
    "react-dom/": "https://esm.sh/react-dom@^19.1.1/",
    "react/": "https://esm.sh/react@^19.1.1/",
    "react": "https://esm.sh/react@^19.1.1",
    "@google/genai": "https://esm.sh/@google/genai@^1.15.0"
  }
}
</script>
</head>
  <body class="theme-midnight">
    <div id="root"></div>
    <script type="module" src="/index.tsx"></script>
  </body>
</html>